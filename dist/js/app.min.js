var app=angular.module("sample",[]);angular.module("sample").controller("firstController",["$scope","createChartService",function(a,t){function e(a){var t={},e=[],r=[],l=[];for(var i in a){var n=a[i].utilizationDate,o=a[i],c=0,s=0,u=0;"india"==o.utilizationLocation.toLowerCase()?(c=o.utilizationValue,r.push({date:n,utilization:c})):"us"==o.utilizationLocation.toLowerCase()?(s=o.utilizationValue,e.push({date:n,utilization:s})):"overall"==o.utilizationLocation.toLowerCase()&&(u=o.utilizationValue,l.push({date:n,utilization:u}))}return t.India={label:"India",data:r,lineColor:"rgb(253, 154, 55)",fill:!1},t.US={label:"US",data:e,lineColor:"rgb(90, 172, 239)",fill:!1},t.Overall={label:"Overall",data:l,lineColor:"gray",fill:!1},t}function r(t){var r=t.data.response;r.successObject&&(a.utilizationChartData=e(r.successObject))}function l(a){console.error("ERROR: Failed in XHR : "+a)}function i(){a.loading=!1}!function(){a.loading=!0,t.getChartData().then(r,l).finally(i)}()}]);var app=angular.module("sample");angular.module("sample").directive("chart",["chartsService",function(a){function t(t,e,r){var l=this;if(l.max=0,console.log(t),"pie"!=t.chartType)var i={id:t.id,datasetLabel:t.datasetLabel,datalabels:!0,maintainAspectRatio:!1,zoom:{enabled:!1,mode:"xy"},pan:{enabled:!1,mode:"xy"},chart:{height:300,type:t.chartType},responsive:!0,legend:{display:t.legendDisplay,position:"bottom"},title:{display:!1,text:"Chart.js Bar Chart"},scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:t.hScaleLabel,fontColor:"#000",fontSize:16}}],yAxes:[{display:!0,ticks:{beginAtZero:!t.yScaleMin,min:t.yScaleMin,max:t.yScaleMax,callback:function(a,e,r){return l.max<a&&(l.max=a),a+t.yScaleSuffix}},scaleLabel:{display:!0,labelString:t.yScaleLabel,fontColor:"#000",fontSize:16}}]},showTooltips:!1,tooltipTemplate:"<%= value %>",tooltips:{callbacks:{title:function(a,t){return a[0].xLabel+" : "+a[0].yLabel},label:function(a,t){t.datasets[a.datasetIndex].label;return""}}}};else if(t.chartType="pie")var i={id:t.id,datasetLabel:t.datasetLabel,chartData:t.chartData,datalabels:!0,maintainAspectRatio:!1,zoom:{enabled:!1,mode:"xy"},pan:{enabled:!1,mode:"xy"},chart:{height:300,type:t.chartType},responsive:!0,legend:{display:t.legendDisplay,position:"bottom"},title:{display:!1,text:"Chart.js Pie Chart"},showTooltips:!0,tooltipTemplate:"<%= value %>"};t.$watchCollection("chartData",function(e,n){if(e){var o=a.generateChartData(t.chartData,t.hAxisProp,t.yAxisProp,JSON.parse(t.dateType),i),c=o.datasets,s=[];for(var u in c)s=s.concat(c[u].data);l.max=s[0];for(var d in s)l.max<s[d]&&(l.max=s[d]);var b=a.drawChart(r.id,o,i);if(b&&"Profitability GM YTD"===b.options.datasetLabel){var h=b.chart.ctx;h.canvas.onclick=function(a){var e=b.getElementsAtEvent(a);console.log(e),t.$emit("datapointClick",e)}}if(b&&"BenchSkillBarChart"===b.options.datasetLabel){var h=b.chart.ctx;h.canvas.onclick=function(a){var e=b.getElementsAtEvent(a);t.$emit("benchBarChartClick",e)}}if(b&&"BenchSkillPieChart"===b.options.datasetLabel){var h=b.chart.ctx;h.canvas.onclick=function(a){var e=b.getElementsAtEvent(a);t.$emit("benchPieChartClick",e)}}if(b&&"PracticeInputBarChart"===b.options.datasetLabel){var h=b.chart.ctx;h.canvas.onclick=function(a){var e=b.getElementsAtEvent(a);t.$emit("practiceBarChartClick",e)}}console.log(b)}})}function e(){}return{restrict:"E",template:"<canvas></canvas>",replace:!0,link:t,controller:e,scope:{id:"=",chartData:"=?",chartType:"=?",hAxisProp:"=?",yAxisProp:"=?",dateType:"=?",datasetLabel:"=?",legendDisplay:"@",yScaleSuffix:"@",hScaleLabel:"@",yScaleLabel:"@",yScaleMin:"@",yScaleMax:"@"}}}]),function(){"use strict";angular.module("sample");angular.module("sample").directive("firstOne",function(){return{restrict:"EA",bindToController:!0,controller:"firstController",controllerAs:"first",replace:!0,templateUrl:"index.html"}})}(),function(){angular.module("sample").service("chartsService",["$http","$rootScope","$window",function(a,t,e){function r(a){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a.getMonth()]+" "+a.getFullYear()}var l=["rgba(0, 234, 221, 0.5)","rgba(232, 140, 209, 0.5)","rgba(174, 140, 232, 0.5)","rgba(0, 169, 19, 0.5)","rgba(137, 204, 0, 0.5)","rgba(204, 176, 0, 0.5)","rgba(206, 105, 23, 0.5)","rgba(255, 99, 132, 0.5)","rgba(54, 162, 235, 0.5)","rgba(136, 255, 0, 0.5)","rgba(142, 48, 160, 0.5)","rgba(0, 222, 220, 0.5)","rgba(255, 206, 86, 0.5)","rgba(75, 192, 192, 0.5)","rgba(0, 234, 221, 0.5)","rgba(153, 102, 255, 0.5)","rgba(139, 126, 255, 0.5)","rgba(142, 48, 160, 0.5)","rgba(191, 6, 6, 0.5)","rgba(153, 102, 255, 0.5)","rgba(255, 206, 86, 0.5)","rgba(65, 196, 255, 0.5)","rgba(137, 204, 0, 0.5)","rgba(0, 169, 19, 0.5)","rgba(255, 159, 64, 0.5)","rgba(142, 48, 160, 0.5)","rgba(255, 206, 86, 0.5)","rgba(0, 222, 220, 0.5)","rgba(137, 204, 0, 0.5)","rgba(174, 140, 232, 0.5)","rgba(0, 169, 19, 0.5)","rgba(137, 204, 0, 0.5)"],i=this;i.charts=[],i.drawChart=function(a,t,e){var r=e.chart&&e.chart.height||300,l=e.chart&&e.chart.width||400,n=e.chart&&e.chart.type||"bar",o=document.getElementById(a).getContext("2d");o.canvas.height=r,o.canvas.width=l;var c=new Chart(o,{type:n,data:t,options:e});return i.charts.push(c),c},i.generateChartData=function(a,t,e,i,n){var o=i||!1,c=n.datasetLabel||"x-axis",s=[],u=[];if(a.constructor!==Array){var d=Object.keys(a);for(var b in d){var h=a[d[b]].data,p=a[d[b]].backgroundColor,g=a[d[b]].fill,v=a[d[b]].lineColor,c=a[d[b]].label,f=[];for(var m in h){var y=h[m][t];y=1==o?r(new Date(y)):y;var C=h[m][e];u.push(y),f.push(C)}var x={label:c,data:f,backgroundColor:p,fill:g,borderColor:v};s.push(x)}}else{var f=[],S=[];for(var b in a){var y=a[b][t];y=1==o?r(new Date(y)):y;var C=a[b][e];a[b].backgroundColor&&S.push(a[b].backgroundColor),null!==y&&u.push(y),f.push(C)}var x={label:c,data:f,backgroundColor:S.length>0?S:l};s.push(x)}var L=u;return{labels:$.unique(L),datasets:s}}}])}(),angular.module("sample").factory("createChartService",["$http",function(a){var t={};return t.getChartData=function(){return a.get("json/data.json")},t}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRyb2xsZXJzL2NoYXJ0LmNvbnRyb2xsZXIuanMiLCJkaXJlY3RpdmVzL2NoYXJ0LmpzIiwiZGlyZWN0aXZlcy9zYW1wbGUuanMiLCJzZXJ2aWNlcy9jaGFydC5zZXJ2aWNlLmpzIiwic2VydmljZXMvY2hhcnRTZXJ2aWNlLnNlcnZpY2UuanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCJjcmVhdGVDaGFydFNlcnZpY2UiLCJnZW5lcmF0ZVV0aWxpemF0aW9uQ2hhcnREYXRhIiwidXRpbGl6YXRpb25zIiwidXRpbGl6YXRpb25DaGFydERhdGEiLCJ1dGlsaXphdGlvblVTIiwidXRpbGl6YXRpb25JbmRpYSIsInV0aWxpemF0aW9uT3ZlcmFsbCIsImkiLCJkYXRlIiwidXRpbGl6YXRpb25EYXRlIiwidXRpbGl6YXRpb24iLCJ1dElOIiwidXRVUyIsInV0QUxMIiwidXRpbGl6YXRpb25Mb2NhdGlvbiIsInRvTG93ZXJDYXNlIiwidXRpbGl6YXRpb25WYWx1ZSIsInB1c2giLCJJbmRpYSIsImxhYmVsIiwiZGF0YSIsImxpbmVDb2xvciIsImZpbGwiLCJVUyIsIk92ZXJhbGwiLCJ1dGlsaXphdGlvbkxpc3RTdWNjZXNzSGFuZGxlciIsInJlc3BvbnNlIiwicmVzdWx0Iiwic3VjY2Vzc09iamVjdCIsImZhaWx1cmVIYW5kbGVyIiwiZXJyb3IiLCJjb25zb2xlIiwiZmluYWxseUhhbmRsZXIiLCJsb2FkaW5nIiwiZ2V0Q2hhcnREYXRhIiwidGhlbiIsImZpbmFsbHkiLCJkaXJlY3RpdmUiLCJjaGFydHNTZXJ2aWNlIiwiY2hhcnRMaW5rZXIiLCJzY29wZSIsImVsZW1lbnQiLCJhdHRycyIsInNlbGYiLCJ0aGlzIiwibWF4IiwibG9nIiwiY2hhcnRUeXBlIiwiY2hhcnRPcHRpb25zIiwiaWQiLCJkYXRhc2V0TGFiZWwiLCJkYXRhbGFiZWxzIiwibWFpbnRhaW5Bc3BlY3RSYXRpbyIsInpvb20iLCJlbmFibGVkIiwibW9kZSIsInBhbiIsImNoYXJ0IiwiaGVpZ2h0IiwidHlwZSIsInJlc3BvbnNpdmUiLCJsZWdlbmQiLCJkaXNwbGF5IiwibGVnZW5kRGlzcGxheSIsInBvc2l0aW9uIiwidGl0bGUiLCJ0ZXh0Iiwic2NhbGVzIiwieEF4ZXMiLCJzY2FsZUxhYmVsIiwibGFiZWxTdHJpbmciLCJoU2NhbGVMYWJlbCIsImZvbnRDb2xvciIsImZvbnRTaXplIiwieUF4ZXMiLCJ0aWNrcyIsImJlZ2luQXRaZXJvIiwieVNjYWxlTWluIiwibWluIiwieVNjYWxlTWF4IiwiY2FsbGJhY2siLCJpbmRleCIsImxhYmVscyIsInlTY2FsZVN1ZmZpeCIsInlTY2FsZUxhYmVsIiwic2hvd1Rvb2x0aXBzIiwidG9vbHRpcFRlbXBsYXRlIiwidG9vbHRpcHMiLCJjYWxsYmFja3MiLCJ0b29sdGlwSXRlbSIsInhMYWJlbCIsInlMYWJlbCIsImRhdGFzZXRzIiwiZGF0YXNldEluZGV4IiwiY2hhcnREYXRhIiwiJHdhdGNoQ29sbGVjdGlvbiIsIm5ld1ZhbCIsIm9sZFZhbCIsImdlbmVyYXRlQ2hhcnREYXRhIiwiaEF4aXNQcm9wIiwieUF4aXNQcm9wIiwiSlNPTiIsInBhcnNlIiwiZGF0ZVR5cGUiLCJjb25jYXQiLCJqIiwiZHJhd0NoYXJ0Iiwib3B0aW9ucyIsImN0eCIsImNhbnZhcyIsIm9uY2xpY2siLCJldnQiLCJhY3RpdmVQb2ludHMiLCJnZXRFbGVtZW50c0F0RXZlbnQiLCIkZW1pdCIsImNoYXJ0Q29udHJvbGxlciIsInJlc3RyaWN0IiwidGVtcGxhdGUiLCJyZXBsYWNlIiwibGluayIsImJpbmRUb0NvbnRyb2xsZXIiLCJjb250cm9sbGVyQXMiLCJ0ZW1wbGF0ZVVybCIsInNlcnZpY2UiLCIkaHR0cCIsIiRyb290U2NvcGUiLCIkd2luZG93IiwiZGF0ZVRvTW9udGgiLCJnZXRNb250aCIsImdldEZ1bGxZZWFyIiwiQ09MT1JTIiwidm0iLCJjaGFydHMiLCJkaXZJZCIsImNhbnZhc0hlaWdodCIsImNhbnZhc1dpZHRoIiwid2lkdGgiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZ2V0Q29udGV4dCIsIkNoYXJ0IiwicmF3RGF0YSIsInhBeGlzUHJvcCIsImlzRGF0ZXR5cGUiLCJjb25zdHJ1Y3RvciIsIkFycmF5IiwiZGF0YXNldE5hbWVzIiwiT2JqZWN0Iiwia2V5cyIsInJhd0RhdGFzZXQiLCJiYWNrZ3JvdW5kQ29sb3IiLCJEYXRlIiwiZGF0YXNldCIsImJvcmRlckNvbG9yIiwiYmFja2dyb3VuZENvbG9ycyIsImxlbmd0aCIsInRydW5jYXRlZExhYmVscyIsIiQiLCJ1bmlxdWUiLCJmYWN0b3J5IiwiZ2V0Il0sIm1hcHBpbmdzIjoiQUFBQSxHQUFBQSxLQUFBQyxRQUFBQyxPQUFBLFlBRUFELFNBQUFDLE9BQUEsVUFBQUMsV0FBQSxtQkFBQSxTQUFBLHFCQUNBLFNBQUFDLEVBQUFDLEdBSUEsUUFBQUMsR0FBQUMsR0FFQSxHQUFBQyxNQUNBQyxLQUNBQyxLQUNBQyxJQUVBLEtBQUEsR0FBQUMsS0FBQUwsR0FBQSxDQUNBLEdBQUFNLEdBQUFOLEVBQUFLLEdBQUFFLGdCQUNBQyxFQUFBUixFQUFBSyxHQUNBSSxFQUFBLEVBQ0FDLEVBQUEsRUFDQUMsRUFBQSxDQUNBLFVBQUFILEVBQUFJLG9CQUFBQyxlQUNBSixFQUFBRCxFQUFBTSxpQkFDQVgsRUFBQVksTUFDQVQsS0FBQUEsRUFDQUUsWUFBQUMsS0FHQSxNQUFBRCxFQUFBSSxvQkFBQUMsZUFDQUgsRUFBQUYsRUFBQU0saUJBQ0FaLEVBQUFhLE1BQ0FULEtBQUFBLEVBQ0FFLFlBQUFFLEtBR0EsV0FBQUYsRUFBQUksb0JBQUFDLGdCQUNBRixFQUFBSCxFQUFBTSxpQkFDQVYsRUFBQVcsTUFDQVQsS0FBQUEsRUFDQUUsWUFBQUcsS0EyQkEsTUFyQkFWLEdBQUFlLE9BQ0FDLE1BQUEsUUFDQUMsS0FBQWYsRUFDQWdCLFVBQUEsb0JBQ0FDLE1BQUEsR0FHQW5CLEVBQUFvQixJQUNBSixNQUFBLEtBQ0FDLEtBQUFoQixFQUNBaUIsVUFBQSxvQkFDQUMs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SCxHQUFBMEgsRUFBQXRJLEdBQUF1SSxFQUNBM0gsR0FBQSxHQUFBNEgsRUFBQWhCLEVBQUEsR0FBQXdCLE1BQUFwSSxJQUFBQSxDQUNBLElBQUFULEdBQUFtSSxFQUFBdEksR0FBQTZGLEVBQ0F5QyxHQUFBdEksR0FBQStJLGlCQUNBSSxFQUFBekksS0FBQTRILEVBQUF0SSxHQUFBK0ksaUJBRUEsT0FBQW5JLEdBQ0ErRCxFQUFBakUsS0FBQUUsR0FFQUMsRUFBQUgsS0FBQVAsR0FHQSxHQUFBOEksSUFDQXJJLE1BQUErQixFQUNBOUIsS0FBQUEsRUFFQWtJLGdCQUFBSSxFQUFBQyxPQUFBLEVBQUFELEVBQUF4QixFQUVBdEMsR0FBQTNFLEtBQUF1SSxHQW1CQSxHQUFBSSxHQUFBMUUsQ0FrQkEsUUFKQUEsT0FBQTJFLEVBQUFDLE9BQUFGLEdBQ0FoRSxTQUFBQSxVQy9OQWhHLFFBQUFDLE9BQUEsVUFDQWtLLFFBQUEsc0JBQUEsUUFBQSxTQUFBbkMsR0FFQSxHQUFBOUIsS0FJQSxPQUhBQSxHQUFBNUQsYUFBQSxXQUNBLE1BQUEwRixHQUFBb0MsSUFBQSxtQkFFQWxFIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ3NhbXBsZScsIFtdKTtcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdzYW1wbGUnKS5jb250cm9sbGVyKCdmaXJzdENvbnRyb2xsZXInLCBbJyRzY29wZScsICdjcmVhdGVDaGFydFNlcnZpY2UnLFxyXG4gICAgZnVuY3Rpb24oJHNjb3BlLCBjcmVhdGVDaGFydFNlcnZpY2UpIHtcclxuXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZW5lcmF0ZVV0aWxpemF0aW9uQ2hhcnREYXRhKHV0aWxpemF0aW9ucykge1xyXG5cclxuICAgICAgICAgICAgdmFyIHV0aWxpemF0aW9uQ2hhcnREYXRhID0ge307XHJcbiAgICAgICAgICAgIHZhciB1dGlsaXphdGlvblVTID0gW107XHJcbiAgICAgICAgICAgIHZhciB1dGlsaXphdGlvbkluZGlhID0gW107XHJcbiAgICAgICAgICAgIHZhciB1dGlsaXphdGlvbk92ZXJhbGwgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gdXRpbGl6YXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0ZSA9IHV0aWxpemF0aW9uc1tpXS51dGlsaXphdGlvbkRhdGU7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXRpbGl6YXRpb24gPSB1dGlsaXphdGlvbnNbaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgdXRJTiA9IDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXRVUyA9IDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXRBTEwgPSAwO1xyXG4gICAgICAgICAgICAgICAgaWYgKHV0aWxpemF0aW9uLnV0aWxpemF0aW9uTG9jYXRpb24udG9Mb3dlckNhc2UoKSA9PSAnaW5kaWEnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXRJTiA9IHV0aWxpemF0aW9uLnV0aWxpemF0aW9uVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdXRpbGl6YXRpb25JbmRpYS5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXRpbGl6YXRpb246IHV0SU5cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHV0aWxpemF0aW9uLnV0aWxpemF0aW9uTG9jYXRpb24udG9Mb3dlckNhc2UoKSA9PSAndXMnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXRVUyA9IHV0aWxpemF0aW9uLnV0aWxpemF0aW9uVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdXRpbGl6YXRpb25VUy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXRpbGl6YXRpb246IHV0VVNcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHV0aWxpemF0aW9uLnV0aWxpemF0aW9uTG9jYXRpb24udG9Mb3dlckNhc2UoKSA9PSAnb3ZlcmFsbCcpIHtcclxuICAgICAgICAgICAgICAgICAgICB1dEFMTCA9IHV0aWxpemF0aW9uLnV0aWxpemF0aW9uVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdXRpbGl6YXRpb25PdmVyYWxsLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBkYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1dGlsaXphdGlvbjogdXRBTExcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHV0aWxpemF0aW9uQ2hhcnREYXRhLkluZGlhID0ge1xyXG4gICAgICAgICAgICAgICAgbGFiZWw6ICdJbmRpYScsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB1dGlsaXphdGlvbkluZGlhLFxyXG4gICAgICAgICAgICAgICAgbGluZUNvbG9yOiAncmdiKDI1MywgMTU0LCA1NSknLFxyXG4gICAgICAgICAgICAgICAgZmlsbDogZmFsc2VcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHV0aWxpemF0aW9uQ2hhcnREYXRhLlVTID0ge1xyXG4gICAgICAgICAgICAgICAgbGFiZWw6ICdVUycsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB1dGlsaXphdGlvblVTLFxyXG4gICAgICAgICAgICAgICAgbGluZUNvbG9yOiAncmdiKDkwLCAxNzIsIDIzOSknLFxyXG4gICAgICAgICAgICAgICAgZmlsbDogZmFsc2VcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHV0aWxpemF0aW9uQ2hhcnREYXRhLk92ZXJhbGwgPSB7XHJcbiAgICAgICAgICAgICAgICBsYWJlbDogJ092ZXJhbGwnLFxyXG4gICAgICAgICAgICAgICAgZGF0YTogdXRpbGl6YXRpb25PdmVyYWxsLFxyXG4gICAgICAgICAgICAgICAgbGluZUNvbG9yOiAnZ3JheScsXHJcbiAgICAgICAgICAgICAgICBmaWxsOiBmYWxzZVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHV0aWxpemF0aW9uQ2hhcnREYXRhO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdXRpbGl6YXRpb25MaXN0U3VjY2Vzc0hhbmRsZXIocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHJlc3BvbnNlLmRhdGEucmVzcG9uc2U7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzc09iamVjdCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnV0aWxpemF0aW9uQ2hhcnREYXRhID0gZ2VuZXJhdGVVdGlsaXphdGlvbkNoYXJ0RGF0YShyZXN1bHQuc3VjY2Vzc09iamVjdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldEFsbFV0aWx6YXRpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgY3JlYXRlQ2hhcnRTZXJ2aWNlXHJcbiAgICAgICAgICAgICAgICAuZ2V0Q2hhcnREYXRhKClcclxuICAgICAgICAgICAgICAgIC50aGVuKHV0aWxpemF0aW9uTGlzdFN1Y2Nlc3NIYW5kbGVyLCBmYWlsdXJlSGFuZGxlcilcclxuICAgICAgICAgICAgICAgIC5maW5hbGx5KGZpbmFsbHlIYW5kbGVyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGdldEFsbFV0aWx6YXRpb24oKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZmFpbHVyZUhhbmRsZXIoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRVJST1I6IEZhaWxlZCBpbiBYSFIgOiAnICsgZXJyb3IpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZmluYWxseUhhbmRsZXIoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXSk7XHJcbiIsInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnc2FtcGxlJyk7XHJcbmFuZ3VsYXIubW9kdWxlKCdzYW1wbGUnKVxyXG4gICAgLmRpcmVjdGl2ZSgnY2hhcnQnLCBbJ2NoYXJ0c1NlcnZpY2UnLFxyXG4gICAgICAgIGZ1bmN0aW9uKGNoYXJ0c1NlcnZpY2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJzxjYW52YXM+PC9jYW52YXM+JyxcclxuICAgICAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBsaW5rOiBjaGFydExpbmtlcixcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IGNoYXJ0Q29udHJvbGxlcixcclxuICAgICAgICAgICAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6ICc9JyxcclxuICAgICAgICAgICAgICAgICAgICBjaGFydERhdGE6ICc9PycsXHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcnRUeXBlOiAnPT8nLFxyXG4gICAgICAgICAgICAgICAgICAgIGhBeGlzUHJvcDogJz0/JyxcclxuICAgICAgICAgICAgICAgICAgICB5QXhpc1Byb3A6ICc9PycsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZVR5cGU6ICc9PycsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YXNldExhYmVsOiAnPT8nLFxyXG4gICAgICAgICAgICAgICAgICAgIGxlZ2VuZERpc3BsYXk6ICdAJyxcclxuICAgICAgICAgICAgICAgICAgICB5U2NhbGVTdWZmaXg6ICdAJyxcclxuICAgICAgICAgICAgICAgICAgICBoU2NhbGVMYWJlbDogJ0AnLFxyXG4gICAgICAgICAgICAgICAgICAgIHlTY2FsZUxhYmVsOiAnQCcsXHJcbiAgICAgICAgICAgICAgICAgICAgeVNjYWxlTWluOiAnQCcsXHJcbiAgICAgICAgICAgICAgICAgICAgeVNjYWxlTWF4OiAnQCdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBjaGFydExpbmtlcihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgICAgICAgICBzZWxmLm1heCA9IDA7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzY29wZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2NvcGUuY2hhcnRUeXBlICE9IFwicGllXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2hhcnRPcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogc2NvcGUuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzZXRMYWJlbDogc2NvcGUuZGF0YXNldExhYmVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhbGFiZWxzOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYWludGFpbkFzcGVjdFJhdGlvOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgLypvbkNsaWNrOiBmdW5jdGlvbihlLCBvLCBmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ2RhdGFwb2ludENsaWNrJywgbyk7XHJcbiAgICAgICAgICAgICAgICAgIH0sKi9cclxuICAgICAgICAgICAgICAgICAgICAgICAgem9vbToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlOiAneHknLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYW46IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZTogJ3h5J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFydDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAzMDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBzY29wZS5jaGFydFR5cGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgLyplbGVtZW50czoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjdGFuZ2xlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyV2lkdGg6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyQ29sb3I6ICdibGFjaycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyU2tpcHBlZDogJ2JvdHRvbSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwqL1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zaXZlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWdlbmQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IHNjb3BlLmxlZ2VuZERpc3BsYXksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ2JvdHRvbScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICdDaGFydC5qcyBCYXIgQ2hhcnQnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeEF4ZXM6IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZUxhYmVsOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsU3RyaW5nOiBzY29wZS5oU2NhbGVMYWJlbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udENvbG9yOiAnIzAwMCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiAxNlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeUF4ZXM6IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWNrczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWdpbkF0WmVybzogc2NvcGUueVNjYWxlTWluID8gZmFsc2UgOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW46IHNjb3BlLnlTY2FsZU1pbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4OiBzY29wZS55U2NhbGVNYXgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbihsYWJlbCwgaW5kZXgsIGxhYmVscykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm1heCA8IGxhYmVsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubWF4ID0gbGFiZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGFiZWwgKyBzY29wZS55U2NhbGVTdWZmaXg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlTGFiZWw6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxTdHJpbmc6IHNjb3BlLnlTY2FsZUxhYmVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250Q29sb3I6ICcjMDAwJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6IDE2XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfV1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvd1Rvb2x0aXBzOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdG9vbHRpcFRlbXBsYXRlOiBcIjwlPSB2YWx1ZSAlPlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgdG9vbHRpcHM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFja3M6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGZ1bmN0aW9uKHRvb2x0aXBJdGVtLCBkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFiZWwgPSBkYXRhLmRhdGFzZXRzW3Rvb2x0aXBJdGVtLmRhdGFzZXRJbmRleF0ubGFiZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGFiZWwgKyAnOiAnICsgdG9vbHRpcEl0ZW0ueUxhYmVsICsgJyhDbGljayBoZXJlIHRvIGdldCBtb3JlIGRhdGFmZmYpJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLyphbmltYXRpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Db21wbGV0ZTogZnVuY3Rpb24gKG9wdHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5jb25maWcudHlwZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN0eCA9IHRoaXMuY2hhcnQuY3R4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5mb250ID0gQ2hhcnQuaGVscGVycy5mb250U3RyaW5nKENoYXJ0LmRlZmF1bHRzLmdsb2JhbC5kZWZhdWx0Rm9udEZhbWlseSwgJ25vcm1hbCcsIENoYXJ0LmRlZmF1bHRzLmdsb2JhbC5kZWZhdWx0Rm9udEZhbWlseSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnRleHRBbGlnbiA9ICdjZW50ZXInO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC50ZXh0QmFzZWxpbmUgPSAnYm90dG9tJztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhLmRhdGFzZXRzLmZvckVhY2goZnVuY3Rpb24gKGRhdGFzZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhc2V0LmRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2RlbCA9IGRhdGFzZXQuX21ldGFbT2JqZWN0LmtleXMoZGF0YXNldC5fbWV0YSlbMF1dLmRhdGFbaV0uX21vZGVsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxUZXh0KGRhdGFzZXQuZGF0YVtpXSwgbW9kZWwueCwgbW9kZWwueSAtIDUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sKi9cclxuICAgICAgICAgICAgICAgICAgICAgICAgdG9vbHRpcHM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBmdW5jdGlvbih0b29sdGlwSXRlbSwgZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG9vbHRpcEl0ZW1bMF0ueExhYmVsICsgJyA6ICcgKyB0b29sdGlwSXRlbVswXS55TGFiZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogZnVuY3Rpb24odG9vbHRpcEl0ZW0sIGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gZGF0YS5kYXRhc2V0c1t0b29sdGlwSXRlbS5kYXRhc2V0SW5kZXhdLmxhYmVsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3JldHVybiBsYWJlbCArICc6ICcgKyB0b29sdGlwSXRlbS55TGFiZWwgKyAnKENsaWNrIGhlcmUgdG8gZ2V0IG1vcmUgZGF0YSknO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNjb3BlLmNoYXJ0VHlwZSA9IFwicGllXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2hhcnRPcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogc2NvcGUuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzZXRMYWJlbDogc2NvcGUuZGF0YXNldExhYmVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFydERhdGE6IHNjb3BlLmNoYXJ0RGF0YSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YWxhYmVsczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWFpbnRhaW5Bc3BlY3RSYXRpbzogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHpvb206IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZTogJ3h5JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFuOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGU6ICd4eSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcnQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogMzAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogc2NvcGUuY2hhcnRUeXBlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNpdmU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZ2VuZDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogc2NvcGUubGVnZW5kRGlzcGxheSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAnYm90dG9tJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0NoYXJ0LmpzIFBpZSBDaGFydCdcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvd1Rvb2x0aXBzOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b29sdGlwVGVtcGxhdGU6IFwiPCU9IHZhbHVlICU+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBpZiAoZWxlbWVudC5jb250ZXh0LmlkID09PSAncHJvZml0YWJpbGl0eScpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBjaGFydE9wdGlvbnMudG9vbHRpcHMgPSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGNhbGxiYWNrczoge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgbGFiZWw6IGZ1bmN0aW9uKHRvb2x0aXBJdGVtLCBkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgcmV0dXJuICdDbGljayBmb3IgbW9yZSBkZXRhaWxzJztcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIH1cclxuXHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCdjaGFydERhdGEnLCBmdW5jdGlvbihuZXdWYWwsIG9sZFZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdWYWwpIHtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hhcnREYXRhID0gY2hhcnRzU2VydmljZS5nZW5lcmF0ZUNoYXJ0RGF0YShzY29wZS5jaGFydERhdGEsIHNjb3BlLmhBeGlzUHJvcCwgc2NvcGUueUF4aXNQcm9wLCBKU09OLnBhcnNlKHNjb3BlLmRhdGVUeXBlKSwgY2hhcnRPcHRpb25zKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhc2V0cyA9IGNoYXJ0RGF0YS5kYXRhc2V0cztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBkYXRhc2V0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGRhdGEuY29uY2F0KGRhdGFzZXRzW2ldLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1heCA9IGRhdGFbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogaW4gZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYubWF4IDwgZGF0YVtqXSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1heCA9IGRhdGFbal07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY2hhcnRPcHRpb25zLnNjYWxlcy55QXhlc1swXS50aWNrcy5tYXggPSAoIHNlbGYubWF4ICApO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGFydCA9IGNoYXJ0c1NlcnZpY2UuZHJhd0NoYXJ0KGF0dHJzLmlkLCBjaGFydERhdGEsIGNoYXJ0T3B0aW9ucyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hhcnQgJiYgY2hhcnQub3B0aW9ucy5kYXRhc2V0TGFiZWwgPT09ICdQcm9maXRhYmlsaXR5IEdNIFlURCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdHggPSBjaGFydC5jaGFydC5jdHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHguY2FudmFzLm9uY2xpY2sgPSBmdW5jdGlvbihldnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBhY3RpdmVQb2ludHMgPSBjaGFydC5nZXREYXRhc2V0QXRFdmVudChldnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY3RpdmVQb2ludHMgPSBjaGFydC5nZXRFbGVtZW50c0F0RXZlbnQoZXZ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhhY3RpdmVQb2ludHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdkYXRhcG9pbnRDbGljaycsIGFjdGl2ZVBvaW50cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGFydCAmJiBjaGFydC5vcHRpb25zLmRhdGFzZXRMYWJlbCA9PT0gJ0JlbmNoU2tpbGxCYXJDaGFydCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdHggPSBjaGFydC5jaGFydC5jdHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHguY2FudmFzLm9uY2xpY2sgPSBmdW5jdGlvbihldnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZlUG9pbnRzID0gY2hhcnQuZ2V0RWxlbWVudHNBdEV2ZW50KGV2dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ2JlbmNoQmFyQ2hhcnRDbGljaycsIGFjdGl2ZVBvaW50cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hhcnQgJiYgY2hhcnQub3B0aW9ucy5kYXRhc2V0TGFiZWwgPT09ICdCZW5jaFNraWxsUGllQ2hhcnQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3R4ID0gY2hhcnQuY2hhcnQuY3R4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmNhbnZhcy5vbmNsaWNrID0gZnVuY3Rpb24oZXZ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVBvaW50cyA9IGNoYXJ0LmdldEVsZW1lbnRzQXRFdmVudChldnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdiZW5jaFBpZUNoYXJ0Q2xpY2snLCBhY3RpdmVQb2ludHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hhcnQgJiYgY2hhcnQub3B0aW9ucy5kYXRhc2V0TGFiZWwgPT09ICdQcmFjdGljZUlucHV0QmFyQ2hhcnQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3R4ID0gY2hhcnQuY2hhcnQuY3R4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmNhbnZhcy5vbmNsaWNrID0gZnVuY3Rpb24oZXZ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVBvaW50cyA9IGNoYXJ0LmdldEVsZW1lbnRzQXRFdmVudChldnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdwcmFjdGljZUJhckNoYXJ0Q2xpY2snLCBhY3RpdmVQb2ludHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjaGFydCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBjaGFydENvbnRyb2xsZXIoKSB7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgXSk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnc2FtcGxlJyk7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnc2FtcGxlJylcclxuICAgICAgICAuZGlyZWN0aXZlKCdmaXJzdE9uZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXHJcbiAgICAgICAgICAgICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2ZpcnN0Q29udHJvbGxlcicsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdmaXJzdCcsXHJcbiAgICAgICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdpbmRleC5odG1sJ1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NhbXBsZScpLlxyXG4gICAgc2VydmljZSgnY2hhcnRzU2VydmljZScsIFsnJGh0dHAnLCAnJHJvb3RTY29wZScsICckd2luZG93JyxcclxuICAgICAgICBmdW5jdGlvbigkaHR0cCwgJHJvb3RTY29wZSwgJHdpbmRvdykge1xyXG5cclxuICAgICAgICAgICAgdmFyIENPTE9SUyA9IFtcclxuICAgICAgICAgICAgICAgICdyZ2JhKDAsIDIzNCwgMjIxLCAwLjUpJyxcclxuICAgICAgICAgICAgICAgICdyZ2JhKDIzMiwgMTQwLCAyMDksIDAuNSknLFxyXG4gICAgICAgICAgICAgICAgJ3JnYmEoMTc0LCAxNDAsIDIzMiwgMC41KScsXHJcbiAgICAgICAgICAgICAgICAncmdiYSgwLCAxNjksIDE5LCAwLjUpJyxcclxuICAgICAgICAgICAgICAgICdyZ2JhKDEzNywgMjA0LCAwLCAwLjUpJyxcclxuICAgICAgICAgICAgICAgICdyZ2JhKDIwNCwgMTc2LCAwLCAwLjUpJyxcclxuICAgICAgICAgICAgICAgICdyZ2JhKDIwNiwgMTA1LCAyMywgMC41KScsXHJcbiAgICAgICAgICAgICAgICAncmdiYSgyNTUsIDk5LCAxMzIsIDAuNSknLFxyXG4gICAgICAgICAgICAgICAgJ3JnYmEoNTQsIDE2MiwgMjM1LCAwLjUpJyxcclxuICAgICAgICAgICAgICAgICdyZ2JhKDEzNiwgMjU1LCAwLCAwLjUpJyxcclxuICAgICAgICAgICAgICAgICdyZ2JhKDE0MiwgNDgsIDE2MCwgMC41KScsXHJcbiAgICAgICAgICAgICAgICAncmdiYSgwLCAyMjIsIDIyMCwgMC41KScsXHJcbiAgICAgICAgICAgICAgICAncmdiYSgyNTUsIDIwNiwgODYsIDAuNSknLFxyXG4gICAgICAgICAgICAgICAgJ3JnYmEoNzUsIDE5MiwgMTkyLCAwLjUpJyxcclxuICAgICAgICAgICAgICAgICdyZ2JhKDAsIDIzNCwgMjIxLCAwLjUpJyxcclxuICAgICAgICAgICAgICAgICdyZ2JhKDE1MywgMTAyLCAyNTUsIDAuNSknLFxyXG4gICAgICAgICAgICAgICAgJ3JnYmEoMTM5LCAxMjYsIDI1NSwgMC41KScsXHJcbiAgICAgICAgICAgICAgICAncmdiYSgxNDIsIDQ4LCAxNjAsIDAuNSknLFxyXG4gICAgICAgICAgICAgICAgJ3JnYmEoMTkxLCA2LCA2LCAwLjUpJyxcclxuICAgICAgICAgICAgICAgICdyZ2JhKDE1MywgMTAyLCAyNTUsIDAuNSknLFxyXG4gICAgICAgICAgICAgICAgJ3JnYmEoMjU1LCAyMDYsIDg2LCAwLjUpJyxcclxuICAgICAgICAgICAgICAgICdyZ2JhKDY1LCAxOTYsIDI1NSwgMC41KScsXHJcbiAgICAgICAgICAgICAgICAncmdiYSgxMzcsIDIwNCwgMCwgMC41KScsXHJcbiAgICAgICAgICAgICAgICAncmdiYSgwLCAxNjksIDE5LCAwLjUpJyxcclxuICAgICAgICAgICAgICAgICdyZ2JhKDI1NSwgMTU5LCA2NCwgMC41KScsXHJcbiAgICAgICAgICAgICAgICAncmdiYSgxNDIsIDQ4LCAxNjAsIDAuNSknLFxyXG4gICAgICAgICAgICAgICAgJ3JnYmEoMjU1LCAyMDYsIDg2LCAwLjUpJyxcclxuICAgICAgICAgICAgICAgICdyZ2JhKDAsIDIyMiwgMjIwLCAwLjUpJyxcclxuICAgICAgICAgICAgICAgICdyZ2JhKDEzNywgMjA0LCAwLCAwLjUpJyxcclxuICAgICAgICAgICAgICAgICdyZ2JhKDE3NCwgMTQwLCAyMzIsIDAuNSknLFxyXG4gICAgICAgICAgICAgICAgJ3JnYmEoMCwgMTY5LCAxOSwgMC41KScsXHJcbiAgICAgICAgICAgICAgICAncmdiYSgxMzcsIDIwNCwgMCwgMC41KScsXHJcbiAgICAgICAgICAgIF07XHJcblxyXG4gICAgICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG5cclxuXHJcbiAgICAgICAgICAgIHZtLmNoYXJ0cyA9IFtdO1xyXG5cclxuXHJcbiAgICAgICAgICAgIHZtLmRyYXdDaGFydCA9IGZ1bmN0aW9uKGRpdklkLCBjaGFydERhdGEsIGNoYXJ0T3B0aW9ucykge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBERUZBVUxUX0NBTlZBU19IRUlHSFQgPSAzMDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgREVGQVVMVF9DQU5WQVNfV0lEVEggPSA0MDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgREVGQVVMVF9DSEFSVF9UWVBFID0gJ2Jhcic7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNhbnZhc0hlaWdodCA9IChjaGFydE9wdGlvbnMuY2hhcnQgJiYgY2hhcnRPcHRpb25zLmNoYXJ0LmhlaWdodCkgfHwgREVGQVVMVF9DQU5WQVNfSEVJR0hUO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNhbnZhc1dpZHRoID0gKGNoYXJ0T3B0aW9ucy5jaGFydCAmJiBjaGFydE9wdGlvbnMuY2hhcnQud2lkdGgpIHx8IERFRkFVTFRfQ0FOVkFTX1dJRFRIO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNoYXJ0VHlwZSA9IChjaGFydE9wdGlvbnMuY2hhcnQgJiYgY2hhcnRPcHRpb25zLmNoYXJ0LnR5cGUpIHx8IERFRkFVTFRfQ0hBUlRfVFlQRTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGl2SWQpLmdldENvbnRleHQoXCIyZFwiKTtcclxuICAgICAgICAgICAgICAgIGN0eC5jYW52YXMuaGVpZ2h0ID0gY2FudmFzSGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgY3R4LmNhbnZhcy53aWR0aCA9IGNhbnZhc1dpZHRoO1xyXG5cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgLypDaGFydC5kZWZhdWx0cy5nbG9iYWwudG9vbHRpcHMuYmFja2dyb3VuZENvbG9yID0gXCIjRUJFQkVCXCI7XHJcbiAgICAgICAgICAgICAgICBDaGFydC5kZWZhdWx0cy5nbG9iYWwudG9vbHRpcHMudGl0bGVGb250Q29sb3IgPSBcIiMwMDBcIjtcclxuICAgICAgICAgICAgICAgIENoYXJ0LmRlZmF1bHRzLmdsb2JhbC50b29sdGlwcy5ib2R5Rm9udENvbG9yID0gXCIjMDAwXCI7Ki9cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNoYXJ0ID0gbmV3IENoYXJ0KGN0eCwge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IGNoYXJ0VHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBjaGFydERhdGEsXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogY2hhcnRPcHRpb25zXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgLypcclxuXHQgICAgXHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdCAgICBcdFx0dmFyIGRhdGEgPSAkd2luZG93Lm15QmFyLmNoYXJ0LmNvbmZpZy5kYXRhLmRhdGFzZXRzWzBdLmRhdGE7XHJcblx0XHQgICAgXHRcclxuXHRcdCAgICBcdGN0eC5mb250ID0gJzIycHggXCJIZWx2ZXRpY2EgTmV1ZVwiLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmJztcclxuXHRcdCAgICBcdGN0eC5maWxsU3R5bGUgPSBcIiMwMDBcIjsgICAgICAgIFxyXG5cdFx0ICAgIFx0Y3R4LnRleHRBbGlnbiA9IFwiY2VudGVyXCI7IFxyXG5cdFx0ICAgIFx0Zm9yICh2YXIgaSBpbiBkYXRhKSB7XHJcblx0XHQgICAgXHRcdGN0eC5maWxsVGV4dChkYXRhW2ldLCAyMDAsIDE4MCk7XHJcblx0XHQgICAgXHR9XHJcblx0ICAgIFx0fSwgMTAwMCk7XHJcblx0ICAgIFx0XHJcblx0ICAgIFx0XHJcblx0ICAgIFx0Ki9cclxuXHJcbiAgICAgICAgICAgICAgICB2bS5jaGFydHMucHVzaChjaGFydCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hhcnQ7XHJcblxyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdm0uZ2VuZXJhdGVDaGFydERhdGEgPSBmdW5jdGlvbihyYXdEYXRhLCB4QXhpc1Byb3AsIHlBeGlzUHJvcCwgZGF0ZVR5cGUsIGNoYXJ0T3B0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgdmFyIERFRkFVTFRfSVNfREFURVRZUEUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHZhciBERUZBVUxUX0RBVEFTRVRfTEFCRUwgPSAneC1heGlzJztcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaXNEYXRldHlwZSA9IGRhdGVUeXBlIHx8IERFRkFVTFRfSVNfREFURVRZUEU7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YXNldExhYmVsID0gY2hhcnRPcHRpb25zLmRhdGFzZXRMYWJlbCB8fCBERUZBVUxUX0RBVEFTRVRfTEFCRUw7XHJcbiAgICAgICAgICAgICAgICAvKlt7XHJcblx0ICAgICAgICBcdCAgZGF0ZTogbmV3IERhdGUoKS5nZXRUaW1lKCksXHJcblx0ICAgICAgICBcdCAgdXRpbGl6YXRpb246IDIzLjQ0LFxyXG5cdCAgICAgICAgXHQgIGxvY2F0aW9uOiAnQUxMJ1xyXG5cdCAgICAgICAgICB9LHtcclxuXHQgICAgICAgIFx0ICBkYXRlOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcclxuXHQgICAgICAgIFx0ICB1dGlsaXphdGlvbjogMjMuNDQsXHJcblx0ICAgICAgICBcdCAgbG9jYXRpb246ICdBTEwnXHJcblx0ICAgICAgICAgIH0se1xyXG5cdCAgICAgICAgXHQgIGRhdGU6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLFxyXG5cdCAgICAgICAgXHQgIHV0aWxpemF0aW9uOiAyMy40NCxcclxuXHQgICAgICAgIFx0ICBsb2NhdGlvbjogJ0FMTCdcclxuXHQgICAgICAgICAgfV07XHJcblx0ICAgICAgICAgICovXHJcblxyXG4gICAgICAgICAgICAgICAgLyp7XHJcblx0ICAgICAgICAgICAgICBsYWJlbHM6IFtcIkphbnVhcnlcIiwgXCJGZWJydWFyeVwiLCBcIk1hcmNoXCIsIFwiQXByaWxcIiwgXCJNYXlcIiwgXCJKdW5lXCIsIFwiSnVseVwiXSxcclxuXHQgICAgICAgICAgICAgIGRhdGFzZXRzOiBbe1xyXG5cdCAgICAgICAgICAgICAgICAgIGxhYmVsOiAnRGF0YXNldCAxJyxcclxuXHQgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwicmdiYSgyMjAsMjIwLDIyMCwwLjUpXCIsXHJcblx0ICAgICAgICAgICAgICAgICAgZGF0YTogWzM0LCAzNCwgNjYsIDIsIDYsIDIzLCA3XVxyXG5cdCAgICAgICAgICAgICAgfSwge1xyXG5cdCAgICAgICAgICAgICAgICAgIGxhYmVsOiAnRGF0YXNldCAyJyxcclxuXHQgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwicmdiYSgxNTEsMTg3LDIwNSwwLjUpXCIsXHJcblx0ICAgICAgICAgICAgICAgICAgZGF0YTogWzcsIDI5LCA5OSwgNjcsIDgzLCA2NiwgOTRdXHJcblx0ICAgICAgICAgICAgICB9LCB7XHJcblx0ICAgICAgICAgICAgICAgICAgbGFiZWw6ICdEYXRhc2V0IDMnLFxyXG5cdCAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogXCJyZ2JhKDE1MSwxODcsMjA1LDAuNSlcIixcclxuXHQgICAgICAgICAgICAgICAgICBkYXRhOiBbMjMsIDQ0LCA1NSwgNjgsIDM0LCA1LCAyXVxyXG5cdCAgICAgICAgICAgICAgfV1cclxuXHJcblx0ICAgICAgICAgIH07Ki9cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YXNldHMgPSBbXTtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGxhYmVscyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJhd0RhdGEuY29uc3RydWN0b3IgIT09IEFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGFzZXROYW1lcyA9IE9iamVjdC5rZXlzKHJhd0RhdGEpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIGRhdGFzZXROYW1lcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmF3RGF0YXNldCA9IHJhd0RhdGFbZGF0YXNldE5hbWVzW2ldXS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmFja2dyb3VuZENvbG9yID0gcmF3RGF0YVtkYXRhc2V0TmFtZXNbaV1dLmJhY2tncm91bmRDb2xvcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGwgPSByYXdEYXRhW2RhdGFzZXROYW1lc1tpXV0uZmlsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmVDb2xvciA9IHJhd0RhdGFbZGF0YXNldE5hbWVzW2ldXS5saW5lQ29sb3I7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhc2V0TGFiZWwgPSByYXdEYXRhW2RhdGFzZXROYW1lc1tpXV0ubGFiZWw7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiBpbiByYXdEYXRhc2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFiZWwgPSByYXdEYXRhc2V0W2pdW3hBeGlzUHJvcF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbCA9IGlzRGF0ZXR5cGUgPT0gdHJ1ZSA/IGRhdGVUb01vbnRoKG5ldyBEYXRlKGxhYmVsKSkgOiBsYWJlbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1dGlsaXphdGlvbiA9IHJhd0RhdGFzZXRbal1beUF4aXNQcm9wXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVscy5wdXNoKGxhYmVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEucHVzaCh1dGlsaXphdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhc2V0ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGRhdGFzZXRMYWJlbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGJhY2tncm91bmRDb2xvcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGw6IGZpbGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXJDb2xvcjogbGluZUNvbG9yXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YXNldHMucHVzaChkYXRhc2V0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhY2tncm91bmRDb2xvcnMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIHJhd0RhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gcmF3RGF0YVtpXVt4QXhpc1Byb3BdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbCA9IGlzRGF0ZXR5cGUgPT0gdHJ1ZSA/IGRhdGVUb01vbnRoKG5ldyBEYXRlKGxhYmVsKSkgOiBsYWJlbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHV0aWxpemF0aW9uID0gcmF3RGF0YVtpXVt5QXhpc1Byb3BdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmF3RGF0YVtpXS5iYWNrZ3JvdW5kQ29sb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcnMucHVzaChyYXdEYXRhW2ldLmJhY2tncm91bmRDb2xvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxhYmVsICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbHMucHVzaChsYWJlbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5wdXNoKHV0aWxpemF0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhc2V0ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogZGF0YXNldExhYmVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2JhY2tncm91bmRDb2xvcjogJ3JnYmEoMTMyLCAyMzEsIDIyMSwgMC44KSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBiYWNrZ3JvdW5kQ29sb3JzLmxlbmd0aCA+IDAgPyBiYWNrZ3JvdW5kQ29sb3JzIDogQ09MT1JTLFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBkYXRhc2V0cy5wdXNoKGRhdGFzZXQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8qdmFyIGRhdGEgPSBbXTtcclxuXHQgICAgXHRmb3IgKHZhciBpIGluIHJhd0RhdGEpIHtcclxuXHQgICAgXHRcdHZhciBsYWJlbCA9IHJhd0RhdGFbaV1beEF4aXNQcm9wXTtcclxuXHQgICAgXHRcdGxhYmVsID0gaXNEYXRldHlwZSA9PSB0cnVlID8gZGF0ZVRvTW9udGgobmV3IERhdGUobGFiZWwpKSA6IGxhYmVsO1xyXG5cdCAgICBcdFx0dmFyIHV0aWxpemF0aW9uID0gcmF3RGF0YVtpXVt5QXhpc1Byb3BdO1xyXG5cdCAgICBcdFx0bGFiZWxzLnB1c2gobGFiZWwpO1xyXG5cdCAgICBcdFx0ZGF0YS5wdXNoKHV0aWxpemF0aW9uKTtcclxuXHQgICAgXHR9XHJcblx0ICAgIFx0XHJcblx0ICAgIFx0dmFyIGRhdGFzZXQgPSB7XHJcblx0XHRcdFx0bGFiZWw6ICdVdGlsaXphdGlvbicsXHJcblx0XHRcdFx0ZGF0YTogZGF0YSxcclxuICAgXHRcdFx0ICAgIGJhY2tncm91bmRDb2xvcjogXCJyZ2JhKDgsIDIwNiwgMTg1LCAwLjUpXCJcclxuXHRcdFx0fVxyXG5cdFx0XHRkYXRhc2V0cy5wdXNoKGRhdGFzZXQpOyovXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHRydW5jYXRlZExhYmVscyA9IGxhYmVscztcclxuICAgICAgICAgICAgICAgIC8qaWYgKGxhYmVscy5sZW5ndGggPiAxNSkge1xyXG5cdCAgICBcdFx0dHJ1bmNhdGVkTGFiZWxzID0gW107XHJcblx0ICAgIFx0XHRmb3IgKHZhciBpIGluIGxhYmVscykge1xyXG5cdCAgICBcdFx0XHR2YXIgZmluYWxTdHIgPSB0cnVuY2F0ZVN0cmluZyhsYWJlbHNbaV0sIDYpO1xyXG5cdCAgICBcdFx0XHRpZiAobGFiZWxzW2ldLmxlbmd0aCA+IDYpIFxyXG5cdCAgICBcdFx0XHRcdGZpbmFsU3RyID0gZmluYWxTdHIgKyAnLi4nO1xyXG5cdCAgICBcdFx0XHRcclxuXHRcdCAgICBcdFx0dHJ1bmNhdGVkTGFiZWxzLnB1c2goZmluYWxTdHIpO1xyXG5cdFx0ICAgIFx0fVxyXG5cdCAgICBcdH1cclxuXHQgICAgXHQqL1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjaGFydERhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGFiZWxzOiAkLnVuaXF1ZSh0cnVuY2F0ZWRMYWJlbHMpLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFzZXRzOiBkYXRhc2V0c1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBjaGFydERhdGE7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNhcGl0YWxpemVGaXJzdExldHRlcihsYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGZpbmFsTGFiZWwgPSBsYWJlbC5zdWJzdHIoMCwgMSkudG9VcHBlckNhc2UoKSArIGxhYmVsLnN1YnN0cigxKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaW5hbExhYmVsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiB0cnVuY2F0ZVN0cmluZyhsYWJlbCwgbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbGFiZWwuc3Vic3RyKDAsIGxlbmd0aCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGN1c3RvbWl6ZVRvb2x0aXAoY2hhcnREYXRhKSB7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gZGF0ZVRvTW9udGgoZGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIE1PTlRIUyA9IFtcIkphblwiLCBcIkZlYlwiLCBcIk1hclwiLCBcIkFwclwiLCBcIk1heVwiLCBcIkp1blwiLCBcIkp1bFwiLCBcIkF1Z1wiLCBcIlNlcFwiLCBcIk9jdFwiLCBcIk5vdlwiLCBcIkRlY1wiXTtcclxuICAgICAgICAgICAgICAgIHZhciBtb250aCA9IE1PTlRIU1tkYXRlLmdldE1vbnRoKCldO1xyXG4gICAgICAgICAgICAgICAgdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vbnRoICsgJyAnICsgeWVhcjtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgfVxyXG4gICAgXSk7XHJcbn0pKCk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKFwic2FtcGxlXCIpXHJcbiAgICAuZmFjdG9yeShcImNyZWF0ZUNoYXJ0U2VydmljZVwiLCBbJyRodHRwJywgZnVuY3Rpb24oJGh0dHApIHtcclxuXHJcbiAgICAgICAgdmFyIGNoYXJ0RGF0YSA9IHt9O1xyXG4gICAgICAgIGNoYXJ0RGF0YS5nZXRDaGFydERhdGEgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnanNvbi9kYXRhLmpzb24nKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBjaGFydERhdGE7XHJcbiAgICB9XSk7XHJcbiJdfQ==
